########################
# Sources
########################
# receive logs from a remote server using the RFC3164 protocol (BSD-syslog protocol).
source s_tcp_rfc3164 {
    network(
        ip("0.0.0.0")
        transport("tcp")
        port(514)
        ip-protocol(4)
    );
};

# receive logs from remote servers using the RFC5424 protocol (IETF-standard syslog protocol).
source s_tcp_rfc5424 { 
    syslog(
        ip("0.0.0.0")
        port(601)
        transport("tcp")
        ip-protocol(4)
    );
};

########################
# Filters
########################

# filter by the source ip of the syslog network connection
#filter f_ipsrc_api {
#    "${SOURCEIP}" eq "10.0.111.11";
#};

# filter by the HOST field of the syslog messages.
#filter f_match_DJANGO_API {
#    match("10.0.111.11" value("HOST")) and 
#};


# filter by the PROGRAM field of the syslog messages.
# api-cisconx
filter f_match_DJANGO_API-CISCONX {
    match("django_api-cisconx" value("PROGRAM"));
};
filter f_match_HTTP_API-CISCONX {
    match("http_api-cisconx" value("PROGRAM"));
};
filter f_match_APACHE_ACCESS_API-CISCONX {
    match("apache_access_api-cisconx" value("PROGRAM"));
};
filter f_match_APACHE_ERROR_API-CISCONX {
    match("apache_error_api-cisconx" value("PROGRAM"));
};
filter f_match_DB_API-CISCONX {
    match("db_api-cisconx" value("PROGRAM"));
};
filter f_match_CONSUL_AG_API-CISCONX {
    match("consul_agent_api-cisconx" value("PROGRAM"));
};
filter f_match_CELERY_API-CISCONX {
    match("celery_api-cisconx" value("PROGRAM"));
};
filter f_match_REDIS_API-CISCONX {
    match("redis_api-cisconx" value("PROGRAM"));
};
filter f_match_MARIADB_ERR_API-CISCONX {
    match("mariadb_error_api-cisconx" value("PROGRAM"));
};
filter f_match_MARIADB_AUDIT_API-CISCONX {
    match("mariadb_audit_api-cisconx" value("PROGRAM"));
};
filter f_match_UPGRADES_API-CISCONX {
    match("unattended-upgrades_api-cisconx" value("PROGRAM"));
};

# api-infoblox
filter f_match_DJANGO_API-INFOBLOX {
    match("django_api-infoblox" value("PROGRAM"));
};
filter f_match_HTTP_API-INFOBLOX {
    match("http_api-infoblox" value("PROGRAM"));
};
filter f_match_APACHE_ACCESS_API-INFOBLOX {
    match("apache_access_api-infoblox" value("PROGRAM"));
};
filter f_match_APACHE_ERROR_API-INFOBLOX {
    match("apache_error_api-infoblox" value("PROGRAM"));
};
filter f_match_DB_API-INFOBLOX {
    match("db_api-infoblox" value("PROGRAM"));
};
filter f_match_CONSUL_AG_API-INFOBLOX {
    match("consul_agent_api-infoblox" value("PROGRAM"));
};
filter f_match_CELERY_API-INFOBLOX {
    match("celery_api-infoblox" value("PROGRAM"));
};
filter f_match_REDIS_API-INFOBLOX {
    match("redis_api-infoblox" value("PROGRAM"));
};
filter f_match_MARIADB_ERR_API-INFOBLOX {
    match("mariadb_error_api-infoblox" value("PROGRAM"));
};
filter f_match_MARIADB_AUDIT_API-INFOBLOX {
    match("mariadb_audit_api-infoblox" value("PROGRAM"));
};
filter f_match_UPGRADES_API-INFOBLOX {
    match("unattended-upgrades_api-infoblox" value("PROGRAM"));
};

# api-f5
filter f_match_DJANGO_API-F5 {
    match("django_api-f5" value("PROGRAM"));
};
filter f_match_HTTP_API-F5 {
    match("http_api-f5" value("PROGRAM"));
};
filter f_match_APACHE_ACCESS_API-F5 {
    match("apache_access_api-f5" value("PROGRAM"));
};
filter f_match_APACHE_ERROR_API-F5 {
    match("apache_error_api-f5" value("PROGRAM"));
};
filter f_match_DB_API-F5 {
    match("db_api-f5" value("PROGRAM"));
};
filter f_match_CONSUL_AG_API-F5 {
    match("consul_agent_api-f5" value("PROGRAM"));
};
filter f_match_CELERY_API-F5 {
    match("celery_api-f5" value("PROGRAM"));
};
filter f_match_REDIS_API-F5 {
    match("redis_api-f5" value("PROGRAM"));
};
filter f_match_MARIADB_ERR_API-F5 {
    match("mariadb_error_api-f5" value("PROGRAM"));
};
filter f_match_MARIADB_AUDIT_API-F5 {
    match("mariadb_audit_api-f5" value("PROGRAM"));
};
filter f_match_UPGRADES_API-F5 {
    match("unattended-upgrades_api-f5" value("PROGRAM"));
};

# aaa
filter f_match_DJANGO_SSO {
    match("django_sso" value("PROGRAM"));
};
filter f_match_HTTP_SSO {
    match("http_sso" value("PROGRAM"));
};
filter f_match_APACHE_ACCESS_SSO{
    match("apache_access_sso" value("PROGRAM"));
};
filter f_match_APACHE_ERROR_SSO {
    match("apache_error_sso" value("PROGRAM"));
};
filter f_match_AUTH_LDAP_SSO {
    match("auth_ldap_sso" value("PROGRAM"));
};
filter f_match_AUTH_RADIUS_SSO {
    match("auth_radius_sso" value("PROGRAM"));
};
filter f_match_CONSUL_AG_SSO {
    match("consul_agent_sso" value("PROGRAM"));
};
filter f_match_MARIADB_ERR_SSO {
    match("mariadb_error_sso" value("PROGRAM"));
};
filter f_match_MARIADB_AUDIT_SSO {
    match("mariadb_audit_sso" value("PROGRAM"));
};
filter f_match_UPGRADES_SSO {
    match("unattended-upgrades_sso" value("PROGRAM"));
};

# uib
filter f_match_DJANGO_UIB {
    match("django_uib" value("PROGRAM"));
};
filter f_match_HTTP_UIB {
    match("http_uib" value("PROGRAM"));
};
filter f_match_APACHE_ACCESS_UIB {
    match("apache_access_uib" value("PROGRAM"));
};
filter f_match_APACHE_ERROR_UIB {
    match("apache_error_uib" value("PROGRAM"));
};
filter f_match_CONSUL_AG_UIB {
    match("consul_agent_uib" value("PROGRAM"));
};
filter f_match_CONSUL_TPL_UIB {
    match("consul_template_uib" value("PROGRAM"));
};
filter f_match_REDIS_UIB {
    match("redis_uib" value("PROGRAM"));
};
filter f_match_MARIADB_ERR_UIB {
    match("mariadb_error_uib" value("PROGRAM"));
};
filter f_match_MARIADB_AUDIT_UIB {
    match("mariadb_audit_uib" value("PROGRAM"));
};
filter f_match_UPGRADES_UIB {
    match("unattended-upgrades_uib" value("PROGRAM"));
};

# uif
filter f_match_APACHE_ACCESS_UIF {
    match("apache_access_uif" value("PROGRAM"));
};
filter f_match_APACHE_ERROR_UIF {
    match("apache_error_uif" value("PROGRAM"));
};
filter f_match_YARN_UIF {
    match("yarn_uif" value("PROGRAM"));
};
filter f_match_CONSUL_AG_UIF {
    match("consul_agent_uif" value("PROGRAM"));
};
filter f_match_UPGRADES_UIF {
    match("unattended-upgrades_uif" value("PROGRAM"));
};

# revp
filter f_match_NGINX_ACC_REVP {
    match("nginx_acc_revp" value("PROGRAM"));
};
filter f_match_NGINX_ERR_REVP {
    match("nginx_err_revp" value("PROGRAM"));
};
filter f_match_CONSUL_AG_REVP {
    match("consul_agent_revp" value("PROGRAM"));
};
filter f_match_CONSUL_TPL_REVP {
    match("consul_template_revp" value("PROGRAM"));
};
filter f_match_UPGRADES_REVP {
    match("unattended-upgrades_revp" value("PROGRAM"));
};

# dns
filter f_match_CONSUL_SRV_DNS {
    match("consul_server_dns" value("PROGRAM"));
};
filter f_match_UPGRADES_DNS {
    match("unattended-upgrades_dns" value("PROGRAM"));
};

########################
# Destinations
########################
# api-cisconx
destination d_django_api-cisconx { file("/var/log/automation/api-cisconx/django_api-cisconx.log"); };
destination d_http_api-cisconx { file("/var/log/automation/api-cisconx/http_api-cisconx.log"); };
destination d_apache_a_api-cisconx { file("/var/log/automation/api-cisconx/apache_access_api-cisconx.log"); };
destination d_apache_e_api-cisconx { file("/var/log/automation/api-cisconx/apache_error_api-cisconx.log"); };
destination d_db_api-cisconx { file("/var/log/automation/api-cisconx/db_api-cisconx.log"); };
destination d_consul_agent_api-cisconx { file("/var/log/automation/api-cisconx/consul_agent_api-cisconx.log"); };
destination d_celery_api-cisconx { file("/var/log/automation/api-cisconx/celery_api-cisconx.log"); };
destination d_redis_api-cisconx { file("/var/log/automation/api-cisconx/redis_api-cisconx.log"); };
destination d_mariadb_err_api-cisconx { file("/var/log/automation/api-cisconx/mysql_err_api-cisconx.log"); };
destination d_mariadb_audit_api-cisconx { file("/var/log/automation/api-cisconx/mysql_audit_api-cisconx.log"); };
destination d_upgrades_api-cisconx { file("/var/log/automation/api-cisconx/unattended_upgrades_api-cisconx.log"); };
# api-infoblox
destination d_django_api-infoblox { file("/var/log/automation/api-infoblox/django_api-infoblox.log"); };
destination d_http_api-infoblox { file("/var/log/automation/api-infoblox/http_api-infoblox.log"); };
destination d_apache_a_api-infoblox { file("/var/log/automation/api-infoblox/apache_access_api-infoblox.log"); };
destination d_apache_e_api-infoblox { file("/var/log/automation/api-infoblox/apache_error_api-infoblox.log"); };
destination d_db_api-infoblox { file("/var/log/automation/api-infoblox/db_api-infoblox.log"); };
destination d_consul_agent_api-infoblox { file("/var/log/automation/api-infoblox/consul_agent_api-infoblox.log"); };
destination d_celery_api-infoblox { file("/var/log/automation/api-infoblox/celery_api-infoblox.log"); };
destination d_redis_api-infoblox { file("/var/log/automation/api-infoblox/redis_api-infoblox.log"); };
destination d_mariadb_err_api-infoblox { file("/var/log/automation/api-infoblox/mysql_err_api-infoblox.log"); };
destination d_mariadb_audit_api-infoblox { file("/var/log/automation/api-infoblox/mysql_audit_api-infoblox.log"); };
destination d_upgrades_api-infoblox { file("/var/log/automation/api-infoblox/unattended_upgrades_api-infoblox.log"); };
# api-f5
destination d_django_api-f5 { file("/var/log/automation/api-f5/django_api-f5.log"); };
destination d_http_api-f5 { file("/var/log/automation/api-f5/http_api-f5.log"); };
destination d_apache_a_api-f5 { file("/var/log/automation/api-f5/apache_access_api-f5.log"); };
destination d_apache_e_api-f5 { file("/var/log/automation/api-f5/apache_error_api-f5.log"); };
destination d_db_api-f5 { file("/var/log/automation/api-f5/db_api-f5.log"); };
destination d_consul_agent_api-f5 { file("/var/log/automation/api-f5/consul_agent_api-f5.log"); };
destination d_celery_api-f5 { file("/var/log/automation/api-f5/celery_api-f5.log"); };
destination d_redis_api-f5 { file("/var/log/automation/api-f5/redis_api-f5.log"); };
destination d_mariadb_err_api-f5 { file("/var/log/automation/api-f5/mysql_err_api-f5.log"); };
destination d_mariadb_audit_api-f5 { file("/var/log/automation/api-f5/mysql_audit_api-f5.log"); };
destination d_upgrades_api-f5 { file("/var/log/automation/api-f5/unattended_upgrades_api-f5.log"); };
# aaa
destination d_django_sso { file("/var/log/automation/sso/django_sso.log"); };
destination d_http_sso { file("/var/log/automation/sso/http_sso.log"); };
destination d_apache_a_sso { file("/var/log/automation/sso/apache_access_sso.log"); };
destination d_apache_e_sso { file("/var/log/automation/sso/apache_error_sso.log"); };
destination d_auth_ldap_sso { file("/var/log/automation/sso/auth_ldap_sso.log"); };
destination d_auth_radius_sso { file("/var/log/automation/sso/auth_radius_sso.log"); };
destination d_consul_agent_sso { file("/var/log/automation/sso/consul_agent_sso.log"); };
destination d_mariadb_err_sso { file("/var/log/automation/sso/mysql_err_sso.log"); };
destination d_mariadb_audit_sso { file("/var/log/automation/sso/mysql_audit_sso.log"); };
destination d_upgrades_sso { file("/var/log/automation/sso/unattended_upgrades_sso.log"); };
# uib
destination d_django_uib { file("/var/log/automation/uib/django_uib.log"); };
destination d_http_uib { file("/var/log/automation/uib/http_uib.log"); };
destination d_apache_a_uib { file("/var/log/automation/uib/apache_access_uib.log"); };
destination d_apache_e_uib { file("/var/log/automation/uib/apache_error_uib.log"); };
destination d_consul_ag_uib { file("/var/log/automation/uib/consul_agent_uib.log"); };
destination d_consul_tpl_uib { file("/var/log/automation/uib/consul_template_uib.log"); };
destination d_redis_uib { file("/var/log/automation/uib/redis_uib.log"); };
destination d_mariadb_err_uib { file("/var/log/automation/uib/mysql_err_uib.log"); };
destination d_mariadb_audit_uib { file("/var/log/automation/uib/mysql_audit_uib.log"); };
destination d_upgrades_uib { file("/var/log/automation/uib/unattended_upgrades_uib.log"); };
# uib
destination d_apache_a_uif { file("/var/log/automation/uif/apache_access_uif.log"); };
destination d_apache_e_uif { file("/var/log/automation/uif/apache_error_uif.log"); };
destination d_yarn_uif { file("/var/log/automation/uif/yarn_uif.log"); };
destination d_consul_ag_uif { file("/var/log/automation/uif/consul_agent_uif.log"); };
destination d_upgrades_uif { file("/var/log/automation/uif/unattended_upgrades_uif.log"); };
# revp
destination d_nginx_acc_revp { file("/var/log/automation/revp/nginx_access_revp.log"); };
destination d_nginx_err_revp { file("/var/log/automation/revp/nginx_error_revp.log"); };
destination d_consul_ag_revp { file("/var/log/automation/revp/consul_agent_revp.log"); };
destination d_consul_tpl_revp { file("/var/log/automation/revp/consul_template_revp.log"); };
destination d_upgrades_revp { file("/var/log/automation/revp/unattended_upgrades_revp.log"); };
# dns
destination d_consul_srv_dns { file("/var/log/automation/dns/consul_server_dns.log"); };
destination d_upgrades_dns { file("/var/log/automation/dns/unattended_upgrades_dns.log"); };
########################
# Log paths
########################
# api-cisconx
log { source(s_tcp_rfc5424); filter(f_match_DJANGO_API-CISCONX); destination(d_django_api-cisconx); };
log { source(s_tcp_rfc5424); filter(f_match_HTTP_API-CISCONX); destination(d_http_api-cisconx); };
log { source(s_tcp_rfc5424); filter(f_match_APACHE_ACCESS_API-CISCONX); destination(d_apache_a_api-cisconx); };
log { source(s_tcp_rfc5424); filter(f_match_APACHE_ERROR_API-CISCONX); destination(d_apache_e_api-cisconx); };
log { source(s_tcp_rfc5424); filter(f_match_DB_API-CISCONX); destination(d_db_api-cisconx); };
log { source(s_tcp_rfc5424); filter(f_match_CONSUL_AG_API-CISCONX); destination(d_consul_agent_api-cisconx); };
log { source(s_tcp_rfc5424); filter(f_match_CELERY_API-CISCONX); destination(d_celery_api-cisconx); };
log { source(s_tcp_rfc5424); filter(f_match_REDIS_API-CISCONX); destination(d_redis_api-cisconx); };
log { source(s_tcp_rfc5424); filter(f_match_MARIADB_ERR_API-CISCONX); destination(d_mariadb_err_api-cisconx); };
log { source(s_tcp_rfc5424); filter(f_match_MARIADB_AUDIT_API-CISCONX); destination(d_mariadb_audit_api-cisconx); };
log { source(s_tcp_rfc5424); filter(f_match_UPGRADES_API-CISCONX); destination(d_upgrades_api-cisconx); };
# api-infoblox
log { source(s_tcp_rfc5424); filter(f_match_DJANGO_API-INFOBLOX); destination(d_django_api-infoblox); };
log { source(s_tcp_rfc5424); filter(f_match_HTTP_API-INFOBLOX); destination(d_http_api-infoblox); };
log { source(s_tcp_rfc5424); filter(f_match_APACHE_ACCESS_API-INFOBLOX); destination(d_apache_a_api-infoblox); };
log { source(s_tcp_rfc5424); filter(f_match_APACHE_ERROR_API-INFOBLOX); destination(d_apache_e_api-infoblox); };
log { source(s_tcp_rfc5424); filter(f_match_DB_API-INFOBLOX); destination(d_db_api-infoblox); };
log { source(s_tcp_rfc5424); filter(f_match_CONSUL_AG_API-INFOBLOX); destination(d_consul_agent_api-infoblox); };
log { source(s_tcp_rfc5424); filter(f_match_CELERY_API-INFOBLOX); destination(d_celery_api-infoblox); };
log { source(s_tcp_rfc5424); filter(f_match_REDIS_API-INFOBLOX); destination(d_redis_api-infoblox); };
log { source(s_tcp_rfc5424); filter(f_match_MARIADB_ERR_API-INFOBLOX); destination(d_mariadb_err_api-infoblox); };
log { source(s_tcp_rfc5424); filter(f_match_MARIADB_AUDIT_API-INFOBLOX); destination(d_mariadb_audit_api-infoblox); };
log { source(s_tcp_rfc5424); filter(f_match_UPGRADES_API-INFOBLOX); destination(d_upgrades_api-infoblox); };
# api-f5
log { source(s_tcp_rfc5424); filter(f_match_DJANGO_API-F5); destination(d_django_api-f5); };
log { source(s_tcp_rfc5424); filter(f_match_HTTP_API-F5); destination(d_http_api-f5); };
log { source(s_tcp_rfc5424); filter(f_match_APACHE_ACCESS_API-F5); destination(d_apache_a_api-f5); };
log { source(s_tcp_rfc5424); filter(f_match_APACHE_ERROR_API-F5); destination(d_apache_e_api-f5); };
log { source(s_tcp_rfc5424); filter(f_match_DB_API-F5); destination(d_db_api-f5); };
log { source(s_tcp_rfc5424); filter(f_match_CONSUL_AG_API-F5); destination(d_consul_agent_api-f5); };
log { source(s_tcp_rfc5424); filter(f_match_CELERY_API-F5); destination(d_celery_api-f5); };
log { source(s_tcp_rfc5424); filter(f_match_REDIS_API-F5); destination(d_redis_api-f5); };
log { source(s_tcp_rfc5424); filter(f_match_MARIADB_ERR_API-F5); destination(d_mariadb_err_api-f5); };
log { source(s_tcp_rfc5424); filter(f_match_MARIADB_AUDIT_API-F5); destination(d_mariadb_audit_api-f5); };
log { source(s_tcp_rfc5424); filter(f_match_UPGRADES_API-F5); destination(d_upgrades_api-f5); };
# aaa
log { source(s_tcp_rfc5424); filter(f_match_DJANGO_SSO); destination(d_django_sso); };
log { source(s_tcp_rfc5424); filter(f_match_HTTP_SSO); destination(d_http_sso); };
log { source(s_tcp_rfc5424); filter(f_match_APACHE_ACCESS_SSO); destination(d_apache_a_sso); };
log { source(s_tcp_rfc5424); filter(f_match_APACHE_ERROR_SSO); destination(d_apache_e_sso); };
log { source(s_tcp_rfc5424); filter(f_match_AUTH_LDAP_SSO); destination(d_auth_ldap_sso); };
log { source(s_tcp_rfc5424); filter(f_match_AUTH_RADIUS_SSO); destination(d_auth_radius_sso); };
log { source(s_tcp_rfc5424); filter(f_match_CONSUL_AG_SSO); destination(d_consul_agent_sso); };
log { source(s_tcp_rfc5424); filter(f_match_MARIADB_ERR_SSO); destination(d_mariadb_err_sso); };
log { source(s_tcp_rfc5424); filter(f_match_MARIADB_AUDIT_SSO); destination(d_mariadb_audit_sso); };
log { source(s_tcp_rfc5424); filter(f_match_UPGRADES_SSO); destination(d_upgrades_sso); };
# uib
log { source(s_tcp_rfc5424); filter(f_match_DJANGO_UIB); destination(d_django_uib); };
log { source(s_tcp_rfc5424); filter(f_match_HTTP_UIB); destination(d_http_uib); };
log { source(s_tcp_rfc5424); filter(f_match_APACHE_ACCESS_UIB); destination(d_apache_a_uib); };
log { source(s_tcp_rfc5424); filter(f_match_APACHE_ERROR_UIB); destination(d_apache_e_uib); };
log { source(s_tcp_rfc5424); filter(f_match_CONSUL_AG_UIB); destination(d_consul_ag_uib); };
log { source(s_tcp_rfc5424); filter(f_match_CONSUL_TPL_UIB); destination(d_consul_tpl_uib); };
log { source(s_tcp_rfc5424); filter(f_match_REDIS_UIB); destination(d_redis_uib); };
log { source(s_tcp_rfc5424); filter(f_match_MARIADB_ERR_UIB); destination(d_mariadb_err_uib); };
log { source(s_tcp_rfc5424); filter(f_match_MARIADB_AUDIT_UIB); destination(d_mariadb_audit_uib); };
log { source(s_tcp_rfc5424); filter(f_match_UPGRADES_UIB); destination(d_upgrades_uib); };
# uif
log { source(s_tcp_rfc5424); filter(f_match_APACHE_ACCESS_UIF); destination(d_apache_a_uif); };
log { source(s_tcp_rfc5424); filter(f_match_APACHE_ERROR_UIF); destination(d_apache_e_uif); };
log { source(s_tcp_rfc5424); filter(f_match_YARN_UIF); destination(d_yarn_uif); };
log { source(s_tcp_rfc5424); filter(f_match_CONSUL_AG_UIF); destination(d_consul_ag_uif); };
log { source(s_tcp_rfc5424); filter(f_match_UPGRADES_UIF); destination(d_upgrades_uif); };
# revp
log { source(s_tcp_rfc5424); filter(f_match_NGINX_ACC_REVP); destination(d_nginx_acc_revp); };
log { source(s_tcp_rfc5424); filter(f_match_NGINX_ERR_REVP); destination(d_nginx_err_revp); };
log { source(s_tcp_rfc5424); filter(f_match_CONSUL_AG_REVP); destination(d_consul_ag_revp); };
log { source(s_tcp_rfc5424); filter(f_match_CONSUL_TPL_REVP); destination(d_consul_tpl_revp); };
log { source(s_tcp_rfc5424); filter(f_match_UPGRADES_REVP); destination(d_upgrades_revp); };
# dns
log { source(s_tcp_rfc5424); filter(f_match_CONSUL_SRV_DNS); destination(d_consul_srv_dns); };
log { source(s_tcp_rfc5424); filter(f_match_UPGRADES_DNS); destination(d_upgrades_dns); };

########################################################################################################################

# @todo: CORPORATE SYSLOG TO BE CONFIGURED.
